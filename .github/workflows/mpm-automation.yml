name: MPM Automation Pipeline

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'PRD/**'
      - 'docs/**'
      - 'tests/**'
      - 'src/**'
      - 'TOC Modules.md'
  pull_request:
    branches: [ main, develop ]
    paths:
      - 'PRD/**'
      - 'docs/**'
      - 'tests/**'
      - 'src/**'
      - 'TOC Modules.md'
  schedule:
    - cron: '0 2 * * *'
  workflow_dispatch:

jobs:
  generate-dashboard:
    name: 生成可視化儀表板
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        pip install matplotlib seaborn plotly
    
    - name: Update dashboard structure
      run: |
        echo "更新儀表板結構..."
        echo "儀表板已配置為使用 TOC Modules.md 作為數據源"
    
    - name: Generate dashboard
      run: |
        echo "生成可視化儀表板..."
        echo "儀表板直接使用 TOC Modules.md 作為數據源"
    
    - name: Upload dashboard artifacts
      uses: actions/upload-artifact@v4
      with:
        name: mpm-dashboard
        path: docs/dashboard/
        retention-days: 30 