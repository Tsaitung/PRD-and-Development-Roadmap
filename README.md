# 菜蟲農食 ERP 系統 - 產品需求文件 (PRD) 與開發路線圖

## 📋 專案概述

本專案包含菜蟲農食 ERP 系統的完整產品需求文件 (Product Requirements Document, PRD)，涵蓋所有模組的詳細規格、功能需求、技術架構和使用者介面設計。同時整合了 **MPM (Module Progress Matrix) 自動化系統**，實現「文件作為唯一真相來源」的理念，並透過 CI/CD Pipeline 自動維護專案進度。

## 🎯 核心特色

### 📊 MPM 自動化進度追蹤
- **文件作為唯一真相來源**: TOC Modules.md 定義模組結構，PRD 模板定義需求規格
- **自動化進度更新**: CI/CD Pipeline 自動更新 MPM 文件
- **即時儀表板**: 現代化可視化進度監控
- **一致性驗證**: 確保 FR-ID、測試、程式碼的一致性

## 📁 專案結構

### 必要檔案說明

| 檔案/目錄 | 用途 | 保留原因 |
|-----------|------|----------|
| **TOC Modules.md** | 模組進度矩陣 (MPM) 中央追蹤文件 | 系統核心資料來源，定義所有模組結構與進度狀態 |
| **IMPLEMENTATION_PLAN.md** | 技術實施計畫與架構決策 | 記錄技術選型、開發策略和系統架構 |
| **TRACKING_GUIDE.md** | 完整追蹤系統使用指南 | 提供詳細的系統操作和最佳實踐指南 |
| **CLAUDE.md** | AI 助理唯一指引文件 | 所有 AI 指令與規範集中於此，請僅遵循此文件 |
| **enhanced_auto_sync.sh** | 自動化 GitHub 同步腳本 | 一鍵執行所有同步作業，確保變更自動推送到 GitHub |
| **.github/** | GitHub Actions 工作流程和自動化腳本 | CI/CD 管線，實現 MPM 自動更新和部署 |
| **PRD/** | 所有 14 個模組的產品需求文件 | 詳細定義每個模組的功能需求和規格 |
| **docs/** | 統一追蹤平台 (GitHub Pages) | 現代化的 Web 追蹤介面，提供即時進度視覺化 |
| **tests/** | 測試套件和驗證腳本 | 確保系統品質和功能正確性 |

## 🔄 自動化同步系統

### 一鍵同步所有變更
```bash
# 執行自動同步
./enhanced_auto_sync.sh

# 監控模式 - 自動偵測並同步變更
./enhanced_auto_sync.sh --watch
```

### 自動化功能
此腳本會自動執行以下操作：
1. **偵測所有檔案變更** - 新增、修改、刪除的檔案
2. **執行模組狀態檢測** - 更新 TOC Modules.md 中的進度
3. **驗證一致性** - 檢查 PRD、測試、程式碼的一致性
4. **生成智能提交訊息** - 根據變更內容自動生成描述
5. **推送到 GitHub** - 自動推送到當前分支
6. **觸發 CI/CD** - GitHub Actions 自動執行後續部署

### GitHub Actions 整合
專案包含完整的 CI/CD 管線：
- **觸發時機**: 任何檔案變更推送到 main/develop 分支
- **每日定時執行**: 凌晨 2 點自動更新進度
- **自動部署**: 更新追蹤平台到 GitHub Pages
- **通知系統**: 成功/失敗自動通知

## 🏗️ 系統架構

菜蟲農食 ERP 系統包含以下 14 個主要模組：

1. **[DSH]** Dashboard 首頁 / 儀表板
2. **[CRM]** Customer Relationship Management 客戶管理
3. **[BDM]** Basic Data Maintenance 基本資料維護
4. **[IM]** Item Management 品項管理
5. **[OP]** Operations Planning 營運計劃
6. **[OM]** Order Management 訂單管理
7. **[MES]** Manufacturing Execution System 生產管理
8. **[WMS]** Warehouse Management System 庫存管理
9. **[PM]** Purchasing Management 採購管理
10. **[LM]** Logistics Management 物流管理
11. **[FA]** Finance & Accounting 財務會計
12. **[BI]** Business Intelligence 分析 & BI
13. **[SA]** System Administration 系統管理
14. **[UP]** User Profile 登出 / 個人資訊

## 🎨 統一追蹤平台

### 📊 功能特色
- **單頁應用程式 (SPA)** - 流暢的使用體驗，無需頁面重載
- **即時數據同步** - 自動從 TOC Modules.md 載入最新進度
- **豐富的視覺化** - 圖表、熱力圖、進度指標
- **團隊協作** - 模組分配、任務管理、成員追蹤
- **反饋系統** - 內建使用者反饋收集功能
- **歷史趨勢分析** - 30天進度追蹤與預測
- **響應式設計** - 支援桌面、平板、手機

### 🚀 訪問方式
- **GitHub Pages**: `https://[your-username].github.io/[repo-name]/`
- **本地開發**: 
  ```bash
  cd docs/tracking-platform
  python -m http.server 8000
  # 訪問 http://localhost:8000
  ```

## 🔧 快速開始指南

### 1. 初始設置
```bash
# 克隆專案
git clone https://github.com/[your-username]/[repo-name].git
cd [repo-name]

# 設置執行權限
chmod +x enhanced_auto_sync.sh

# 執行首次同步
./enhanced_auto_sync.sh
```

### 2. 日常使用
```bash
# 方式一：手動執行同步
./enhanced_auto_sync.sh

# 方式二：開啟監控模式（推薦）
./enhanced_auto_sync.sh --watch
# 系統會每 60 秒檢查變更並自動同步
```

### 3. 查看進度
- 訪問 GitHub Pages 上的追蹤平台
- 查看 TOC Modules.md 的進度矩陣
- 檢查 GitHub Actions 執行狀態

## 📊 模組進度追蹤

### 狀態標記說明
| 符號 | 狀態 | 說明 |
|------|------|------|
| ✅ | 完成 | 功能已完全實現並測試通過 |
| 🟡 | 開發中 | 正在積極開發中 |
| 🔴 | 未開始 | 尚未開始開發 |
| ⚪ | 規劃中 | PRD 規劃階段 |

### 追蹤維度
系統追蹤 9 個關鍵維度：
1. **舊系統運行狀態** - 現有系統運作情況
2. **新系統更新進度** - 新功能開發進度
3. **PRD 文件完成度** - 需求文件撰寫狀態
4. **系統整合狀態** - 模組間整合情況
5. **單元測試覆蓋** - 單元測試完成度
6. **整合測試完成** - 整合測試執行狀態
7. **錯誤追蹤管理** - Bug 修復情況
8. **上線部署進度** - 生產環境部署狀態
9. **TOC可視化回報** - 追蹤系統更新狀態

## 🛠️ 開發指南

### 📝 模組縮寫規則
- **主要模組**: 2-3個字母縮寫 (如: DSH, CRM, IM)
- **子模組**: 主模組-功能縮寫 (如: CRM-CM, PM-SRM)
- **詳細功能**: 多層級縮寫 (如: CRM-PM-DBPE-CBC)

### 📋 PRD 文件格式
```markdown
# [FR-001] 功能需求標題

## 狀態
✅ 完成 | 🟡 開發中 | 🔴 未開始 | ⚪ 規劃中

## 功能描述
...

## 驗收標準
...
```

### 🧪 測試檔案命名
```bash
# 測試檔案應與 FR-ID 對應
tests/unit/FR-001.spec.js
tests/integration/FR-001.test.js
```

## 📚 PRD 撰寫標準與驗證規則

### FR-ID 編碼規則
每份 PRD 必須設定唯一的 FR-ID，格式為：
- **格式**: `FR-<主模組>-<子模組>-<序號>`
- **範例**: 
  - `FR-DSH-OV-001` (儀表板-總覽-功能001)
  - `FR-CRM-PM-001` (CRM-定價管理-功能001)
  - `FR-CRM-PM-DBPE-001` (多層級子模組)

### 檔案結構與命名
- **資料夾**: `[數字編號]-[模組縮寫]-[模組全名]/`
- **子模組**: `[編號].[子編號]-[模組]-[子模組]-[名稱]/`
- **PRD檔案**: 主模組用 `README.md`，子模組用 `prd.md`

### 功能性需求撰寫規範

每項功能需求(FR)必須包含以下子欄位：

#### 必填欄位
1. **條件/觸發**: 描述觸發此需求的前提條件（當...時）
2. **行為**: 系統應執行的行為（則系統...）
3. **資料輸入**: 涉及的輸入資料和格式
4. **資料輸出**: 產生的資料結果
5. **UI反應**: 前端介面的可見回應
6. **例外處理**: 異常情況的處理方式
7. **優先級**: P0（最高）/ P1 / P2

#### 撰寫要求
- 使用明確的因果關係：「當X發生，則系統執行Y」
- 避免模糊詞彙，使用可量化的描述
- 每項FR應獨立完整，不依賴其他FR的理解
- 複雜功能應拆分為多條FR

### 非功能性需求(NFR)規範

根據功能特性選填以下項目：

- **性能**: 延遲目標（P95）、吞吐量（QPS）
- **安全**: 加密標準、認證授權機制
- **可用性**: SLA目標、故障轉移時間
- **擴展性**: 併發用戶數、節點擴充能力
- **可維運性**: 日誌規範、監控指標

若某項不適用，標註「無特殊要求」即可。

### 用戶故事格式

#### 三類故事模板
1. **正向故事**: 「身為[角色]，我希望[功能]，因為[價值]」
2. **反向故事**: 「當[異常]時，系統應[處理]」
3. **極端故事**: 「當[極限條件]時，系統仍應[表現]」

每個主要功能至少提供一則正向故事。

### 系統設計要素

#### 資料模型
使用 TypeScript 介面或類似格式定義：
```typescript
interface Entity {
  id: string;
  // 其他欄位
  createdAt: Date;
  updatedAt: Date;
}
```

#### API契約
明確定義：
- 端點URL和HTTP方法
- Request/Response結構
- 錯誤狀態碼和訊息格式

#### 流程圖
使用Mermaid語法描述系統流程，嵌於` ```mermaid `區塊中。

### 驗收標準(AC)格式

使用結構化YAML格式便於自動化測試：
```yaml
- 條件: 用戶輸入有效資料
  預期結果: 系統返回成功訊息

- 條件: 庫存不足
  預期結果: 顯示庫存不足錯誤
```

每條FR應對應多條AC，涵蓋正向和異常路徑。

### 風險與依賴

#### 必須評估的風險類別
- **技術債風險**: 臨時方案或需重構部分
- **相容性風險**: API變更影響、資料遷移需求
- **資料品質風險**: 輸入驗證、資料清理機制

#### 依賴管理
- 列出外部服務、API、資料庫依賴
- 標註強/弱依賴關係
- 記錄版本要求

### 追蹤與驗證

#### 必填追蹤項目
- **Owner負責人**: 功能主要負責人
- **相關PR/Issue**: 實作時補充連結
- **測試覆蓋率**: 單元測試目標≥80%
- **驗證環境**: Staging/QA環境

### 版本號規範
- **v1.0.0**: 初始版本
- **v1.1.0**: 新增功能
- **v1.0.1**: 錯誤修正

### PRD審查檢查清單

✅ 必填欄位均已填寫
✅ FR-ID格式正確且唯一
✅ 每項FR包含完整子欄位
✅ 驗收標準可測試可量化
✅ 風險評估完整
✅ 版本和負責人明確

## 📈 預期效益

### 效率提升
- **手動更新時間減少**: ≥ 80%
- **錯誤發現時間縮短**: ≥ 70%
- **決策支援響應時間**: ≤ 5分鐘

### 品質提升
- **文件與程式碼一致性**: ≥ 95%
- **FR-ID 追蹤完整性**: ≥ 98%
- **進度報告準確性**: ≥ 90%

### 團隊協作
- **統一的進度視圖**: 促進團隊溝通
- **即時狀態更新**: 減少資訊不對稱
- **自動化驗證**: 確保開發品質

## 🛠️ 故障排除

### 常見問題
1. **同步失敗**: 檢查網路連線和 Git 設定
2. **權限錯誤**: 確保腳本有執行權限 `chmod +x enhanced_auto_sync.sh`
3. **Python 錯誤**: 安裝 Python 3.x 版本

### 手動修復
```bash
# 查看 Git 狀態
git status

# 手動添加所有變更
git add -A

# 手動提交
git commit -m "手動同步"

# 手動推送
git push origin main
```

## 📞 支援與維護

### 問題回報
如遇到問題，請：
1. 檢查 enhanced_auto_sync.sh 執行輸出
2. 查看 GitHub Actions 執行日誌
3. 在 GitHub Issues 中回報問題

### 定期維護
- 每月檢查同步腳本執行狀態
- 每季度更新追蹤平台功能
- 每年檢討和優化自動化流程

## 📄 版本資訊

- **版本**: 2.0.0
- **最後更新**: 2025年8月18日
- **主要更新**: 
  - 統一追蹤平台整合
  - 完整自動化同步系統
  - 團隊協作功能
  - 歷史趨勢分析

---

© 2025 菜蟲農食. All rights reserved.
